{
  "meta": {
    "audit_id": "AUDIT_20251222_1515",
    "target": {
      "repo_name": "Auth-Spine",
      "commit": "7af3791",
      "branch": "main",
      "app_type": "web",
      "auth_model": "hybrid"
    },
    "auditor_mode": "COMPREHENSIVE_SECURITY_AUDIT",
    "run_type": "consolidated",
    "timestamp_utc": "2025-12-22T15:15:00Z",
    "scope": [
      "authentication_bypass",
      "password_management",
      "authorization_access_control",
      "xss",
      "sqli_nosqli",
      "command_injection",
      "code_injection"
    ]
  },
  "summary": {
    "counts": {
      "confirmed": 1,
      "likely": 0,
      "possible": 0,
      "inconclusive": 0,
      "not_detected_categories": 6
    },
    "risk": {
      "highest_severity": "high",
      "highest_risk_score": 15,
      "gate_status": "FAIL"
    },
    "top_findings": [
      {
        "vuln_id": "VULN-PWD-001",
        "title": "Critical Password Hashing Vulnerability",
        "severity": "high",
        "risk_score": 15,
        "status": "CONFIRMED"
      }
    ]
  },
  "categories": [
    {
      "category": "authentication_bypass",
      "checklist": [
        {
          "item": "Map all authentication entry points",
          "result": "CONFIRMED",
          "notes": "Multiple authentication endpoints identified: login, register, logout, MFA"
        },
        {
          "item": "Analyze authentication logic for exploitable flaws",
          "result": "CONFIRMED",
          "notes": "Session-based JWT with database validation properly implemented"
        },
        {
          "item": "Check for hardcoded credentials",
          "result": "NOT_DETECTED",
          "notes": "Environment variables required for JWT secrets"
        },
        {
          "item": "Verify session token generation",
          "result": "CONFIRMED",
          "notes": "JWT with HS256 algorithm and proper signing"
        },
        {
          "item": "Check rate limiting implementation",
          "result": "CONFIRMED",
          "notes": "IP-based rate limiting with exponential backoff"
        }
      ],
      "findings": [
        {
          "vuln_id": "VULN-AUTH-001",
          "status": "NOT_DETECTED",
          "category": "authentication_bypass",
          "title": "Authentication System Properly Implemented",
          "location": {
            "files": [
              {
                "path": "apps/business-spine/src/core/auth.ts",
                "lines": "L16-L36",
                "symbols": ["getActor"]
              },
              {
                "path": "apps/business-spine/src/auth/session.ts",
                "lines": "L23-L33",
                "symbols": ["verifySession"]
              },
              {
                "path": "apps/business-spine/middleware.ts",
                "lines": "L91-L101",
                "symbols": ["middleware"]
              }
            ],
            "routes_endpoints": ["POST /api/auth/login_password", "POST /api/auth/login", "POST /api/auth/register"],
            "middleware": ["middleware.ts"]
          },
          "description": "Authentication system properly implemented with session-based JWT validation against database. Tokens extracted from httpOnly cookies only, preventing header injection attacks. Rate limiting with exponential backoff prevents brute force attacks.",
          "attack_scenario": [
            "Attacker attempts authentication bypass via header injection",
            "System rejects header-based auth, requires httpOnly cookies per apps/business-spine/src/core/auth.ts L17",
            "Session validated against database per apps/business-spine/src/auth/session.ts L27",
            "Rate limiting enforced per apps/business-spine/src/security/rate-limit.ts L25-L48"
          ],
          "evidence": [
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/src/core/auth.ts",
              "lines": "L17-L25",
              "excerpt": "const cookieHeader = req.headers.get('cookie'); if (!cookieHeader) throw new AuthenticationError('Missing session cookie');"
            },
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/src/auth/session.ts",
              "lines": "L27",
              "excerpt": "const sess = await prisma.session.findFirst({ where: { tokenHash, revokedAt: null, expiresAt: { gt: new Date() } } });"
            },
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/src/security/rate-limit.ts",
              "lines": "L25-L48",
              "excerpt": "export function isRateLimited(ip: string): boolean { const entry = rateLimitStore.get(ip); if (!entry) return false; }"
            }
          ],
          "impact": {
            "confidentiality": "Protected - proper session validation prevents unauthorized access",
            "integrity": "Protected - JWT signature prevents token tampering",
            "availability": "Protected - rate limiting prevents abuse",
            "privilege_escalation": "Prevented - role extracted from verified JWT",
            "business": "Protected - user identity properly validated"
          },
          "scoring": {
            "exploitability": 0,
            "impact": 0,
            "exposure_surface": 0,
            "privilege_gain": 0,
            "total_risk_score": 0,
            "severity": "informational",
            "score_justification": "Authentication properly implemented with multiple layers of security"
          },
          "confidence": "HIGH",
          "affected_components": ["Authentication system", "Session management", "Rate limiting"],
          "prerequisites": ["None - authentication properly secured"],
          "notes": "Strong authentication implementation with session management, rate limiting, and proper token validation"
        }
      ],
      "not_detected_statement": "No authentication bypass vulnerabilities detected. The system implements proper session-based JWT authentication with database validation, rate limiting, and secure cookie handling."
    },
    {
      "category": "password_management",
      "checklist": [
        {
          "item": "Trace password lifecycle",
          "result": "CONFIRMED",
          "notes": "Critical vulnerability found in admin users endpoint"
        },
        {
          "item": "Check for plaintext storage",
          "result": "CONFIRMED",
          "notes": "Insecure password hashing discovered"
        },
        {
          "item": "Verify hashing algorithms",
          "result": "CONFIRMED",
          "notes": "Mixed implementation - argon2 in some places, insecure in others"
        },
        {
          "item": "Check password transmission",
          "result": "CONFIRMED",
          "notes": "HTTPS enforced via secure cookie flags"
        },
        {
          "item": "Verify rate limiting on auth attempts",
          "result": "CONFIRMED",
          "notes": "Rate limiting properly implemented"
        }
      ],
      "findings": [
        {
          "vuln_id": "VULN-PWD-001",
          "status": "CONFIRMED",
          "category": "password_management",
          "title": "Critical Password Hashing Vulnerability",
          "location": {
            "files": [
              {
                "path": "apps/business-spine/app/api/admin/users/route.ts",
                "lines": "L97-L150",
                "symbols": ["hashPassword"]
              }
            ],
            "routes_endpoints": ["POST /api/admin/users"],
            "middleware": []
          },
          "description": "Critical security vulnerability in password hashing implementation. The hashPassword function in apps/business-spine/app/api/admin/users/route.ts L147-L150 uses insecure concatenation instead of proper cryptographic hashing. Passwords are stored as 'hashed_' + originalPassword, making them easily reversible.",
          "attack_scenario": [
            "Attacker gains access to database or admin API",
            "Passwords stored as 'hashed_' + originalPassword per apps/business-spine/app/api/admin/users/route.ts L149",
            "Attacker can easily reverse passwords by removing 'hashed_' prefix",
            "Complete compromise of user credentials possible"
          ],
          "evidence": [
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/app/api/admin/users/route.ts",
              "lines": "L147-L150",
              "excerpt": "async function hashPassword(password: string): Promise<string> { return `hashed_${password}`; }"
            },
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/app/api/admin/users/route.ts",
              "lines": "L98",
              "excerpt": "const hashedPassword = await hashPassword(validatedData.password);"
            },
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/app/api/admin/users/route.ts",
              "lines": "L103",
              "excerpt": "password: hashedPassword,"
            }
          ],
          "impact": {
            "confidentiality": "CRITICAL - All admin-created user passwords easily recoverable",
            "integrity": "HIGH - Attacker can impersonate any admin-created user",
            "availability": "MEDIUM - System access compromised through credential theft",
            "privilege_escalation": "CRITICAL - Direct access to user accounts",
            "business": "CRITICAL - Complete compromise of user authentication system"
          },
          "scoring": {
            "exploitability": 5,
            "impact": 5,
            "exposure_surface": 3,
            "privilege_gain": 5,
            "total_risk_score": 15,
            "severity": "high",
            "score_justification": "Insecure password hashing allows easy credential recovery and account takeover"
          },
          "confidence": "HIGH",
          "affected_components": ["Admin user creation", "Password storage", "Authentication system"],
          "prerequisites": ["Database access or API access to admin endpoints"],
          "notes": "Critical vulnerability requiring immediate remediation. All admin-created user passwords are insecurely stored."
        }
      ],
      "not_detected_statement": "Critical password management vulnerability detected. Insecure password hashing implementation in admin users endpoint allows easy password recovery."
    },
    {
      "category": "authorization_access_control",
      "checklist": [
        {
          "item": "Identify protected resources",
          "result": "CONFIRMED",
          "notes": "Comprehensive RBAC system implemented"
        },
        {
          "item": "Verify server-side authorization enforcement",
          "result": "CONFIRMED",
          "notes": "RBAC middleware properly implemented"
        },
        {
          "item": "Detect horizontal privilege escalation",
          "result": "CONFIRMED",
          "notes": "Resource ownership verification implemented"
        },
        {
          "item": "Detect vertical privilege escalation",
          "result": "CONFIRMED",
          "notes": "Role hierarchy properly enforced"
        },
        {
          "item": "Check for IDOR vulnerabilities",
          "result": "CONFIRMED",
          "notes": "Ownership checks prevent IDOR attacks"
        }
      ],
      "findings": [
        {
          "vuln_id": "VULN-AUTHZ-001",
          "status": "NOT_DETECTED",
          "category": "authorization_access_control",
          "title": "Comprehensive Authorization Controls Implemented",
          "location": {
            "files": [
              {
                "path": "apps/business-spine/src/lib/rbac-middleware.ts",
                "lines": "L73-L80",
                "symbols": ["hasPermission"]
              },
              {
                "path": "apps/business-spine/middleware.ts",
                "lines": "L104-L161",
                "symbols": ["middleware"]
              },
              {
                "path": "apps/business-spine/app/api/booking/create/route.ts",
                "lines": "L24-L36",
                "symbols": ["POST"]
              }
            ],
            "routes_endpoints": ["All protected API endpoints"],
            "middleware": ["middleware.ts", "rbac-middleware.ts"]
          },
          "description": "Comprehensive RBAC system with role-based permissions, resource ownership verification, and audit logging. Authorization checks enforced server-side on all protected endpoints.",
          "attack_scenario": [
            "Attacker attempts unauthorized access to protected resources",
            "RBAC middleware validates permissions per apps/business-spine/src/lib/rbac-middleware.ts L73-L80",
            "Resource ownership verified per apps/business-spine/app/api/booking/create/route.ts L30",
            "Unauthorized attempts logged per apps/business-spine/src/lib/rbac-middleware.ts L174-L188"
          ],
          "evidence": [
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/src/lib/rbac-middleware.ts",
              "lines": "L73-L80",
              "excerpt": "export function hasPermission(role: Role, resource: string, action: string): boolean { const permissions = ROLE_PERMISSIONS[role]; return permissions.some(permission => (permission.resource === '*' || permission.resource === resource) && permission.action === action); }"
            },
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/middleware.ts",
              "lines": "L108-L119",
              "excerpt": "const userRoleLevel = ROLE_HIERARCHY[payload.role as keyof typeof ROLE_HIERARCHY] || 0; if (userRoleLevel < ROUTE_MIN_ROLE.admin) return NextResponse.json({ error: 'insufficient permissions' }, { status: 403 });"
            },
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/app/api/booking/create/route.ts",
              "lines": "L30",
              "excerpt": "if (!provider || provider.userId !== actor.userId) return NextResponse.json({ error: 'Unauthorized: You do not own this provider' }, { status: 403 });"
            }
          ],
          "impact": {
            "confidentiality": "Protected - proper authorization prevents data access",
            "integrity": "Protected - users cannot modify others' data",
            "availability": "Protected - resource abuse prevented",
            "privilege_escalation": "Prevented - role hierarchy enforced",
            "business": "Protected - access control maintained"
          },
          "scoring": {
            "exploitability": 0,
            "impact": 0,
            "exposure_surface": 0,
            "privilege_gain": 0,
            "total_risk_score": 0,
            "severity": "informational",
            "score_justification": "Authorization properly implemented with comprehensive RBAC system"
          },
          "confidence": "HIGH",
          "affected_components": ["RBAC system", "Resource ownership verification", "Audit logging"],
          "prerequisites": ["None - authorization properly secured"],
          "notes": "Strong authorization implementation with role-based access control and ownership verification"
        }
      ],
      "not_detected_statement": "No authorization vulnerabilities detected. Comprehensive RBAC system with proper role enforcement and resource ownership verification."
    },
    {
      "category": "xss",
      "checklist": [
        {
          "item": "Identify user input reflection points",
          "result": "NOT_DETECTED",
          "notes": "No unsafe DOM manipulation found"
        },
        {
          "item": "Check output encoding",
          "result": "CONFIRMED",
          "notes": "React auto-escaping provides protection"
        },
        {
          "item": "Verify framework protections",
          "result": "CONFIRMED",
          "notes": "Next.js and React provide XSS protection"
        },
        {
          "item": "Check unsafe DOM manipulation",
          "result": "NOT_DETECTED",
          "notes": "No innerHTML or dangerouslySetInnerHTML found"
        },
        {
          "item": "Verify CSP implementation",
          "result": "CONFIRMED",
          "notes": "Comprehensive CSP headers configured"
        }
      ],
      "findings": [
        {
          "vuln_id": "VULN-XSS-001",
          "status": "NOT_DETECTED",
          "category": "xss",
          "title": "XSS Protections Properly Implemented",
          "location": {
            "files": [
              {
                "path": "apps/business-spine/middleware.ts",
                "lines": "L52-L63",
                "symbols": ["middleware"]
              }
            ],
            "routes_endpoints": ["All routes"],
            "middleware": ["middleware.ts"]
          },
          "description": "XSS protection implemented through multiple layers: React auto-escaping, Content Security Policy headers, and absence of unsafe DOM manipulation patterns.",
          "attack_scenario": [
            "Attacker attempts XSS injection via user input",
            "React auto-escaping neutralizes script injection",
            "CSP headers restrict script sources per apps/business-spine/middleware.ts L52-L63",
            "No unsafe DOM manipulation patterns found in codebase"
          ],
          "evidence": [
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/middleware.ts",
              "lines": "L52-L63",
              "excerpt": "res.headers.set('Content-Security-Policy', 'default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https:; frame-ancestors 'none'; base-uri 'self'; form-action 'self'');"
            },
            {
              "type": "code_search",
              "path": "codebase",
              "lines": "search results",
              "excerpt": "No innerHTML, dangerouslySetInnerHTML, eval, or unsafe DOM manipulation found"
            }
          ],
          "impact": {
            "confidentiality": "Protected - CSP mitigates XSS impact",
            "integrity": "Protected - script injection prevented",
            "availability": "Protected - malware distribution prevented",
            "privilege_escalation": "Prevented - XSS attacks blocked",
            "business": "Protected - user data and reputation protected"
          },
          "scoring": {
            "exploitability": 0,
            "impact": 0,
            "exposure_surface": 0,
            "privilege_gain": 0,
            "total_risk_score": 0,
            "severity": "informational",
            "score_justification": "Multiple layers of XSS protection properly implemented"
          },
          "confidence": "HIGH",
          "affected_components": ["Content Security Policy", "React auto-escaping", "Security headers"],
          "prerequisites": ["None - XSS protection properly implemented"],
          "notes": "Strong XSS protection through CSP, framework protections, and secure coding practices"
        }
      ],
      "not_detected_statement": "No XSS vulnerabilities detected. Multiple layers of protection including CSP, React auto-escaping, and absence of unsafe DOM manipulation."
    },
    {
      "category": "sqli_nosqli",
      "checklist": [
        {
          "item": "Locate database query construction",
          "result": "CONFIRMED",
          "notes": "Prisma ORM used throughout application"
        },
        {
          "item": "Verify parameterization",
          "result": "CONFIRMED",
          "notes": "Prisma automatically parameterizes all queries"
        },
        {
          "item": "Check for string concatenation",
          "result": "NOT_DETECTED",
          "notes": "No raw SQL concatenation found"
        },
        {
          "item": "Verify ORM usage",
          "result": "CONFIRMED",
          "notes": "Consistent Prisma ORM usage"
        },
        {
          "item": "Check for raw queries",
          "result": "NOT_DETECTED",
          "notes": "No raw SQL queries found"
        }
      ],
      "findings": [
        {
          "vuln_id": "VULN-SQLI-001",
          "status": "NOT_DETECTED",
          "category": "sqli_nosqli",
          "title": "SQL Injection Prevented by Prisma ORM",
          "location": {
            "files": [
              {
                "path": "apps/business-spine/app/api/auth/login_password/route.ts",
                "lines": "L29",
                "symbols": ["prisma.user.findUnique"]
              },
              {
                "path": "apps/business-spine/app/api/booking/create/route.ts",
                "lines": "L51-L61",
                "symbols": ["prisma.booking.create"]
              }
            ],
            "routes_endpoints": ["All database-accessing endpoints"],
            "middleware": []
          },
          "description": "SQL injection prevented through consistent use of Prisma ORM which automatically parameterizes all queries and prevents injection attacks.",
          "attack_scenario": [
            "Attacker attempts SQL injection via user input",
            "Prisma ORM automatically parameterizes queries per apps/business-spine/app/api/auth/login_password/route.ts L29",
            "No raw SQL construction found in codebase",
            "Malicious SQL cannot be injected through ORM"
          ],
          "evidence": [
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/app/api/auth/login_password/route.ts",
              "lines": "L29",
              "excerpt": "const user = await prisma.user.findUnique({ where: { email: body.email } });"
            },
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/app/api/booking/create/route.ts",
              "lines": "L51-L61",
              "excerpt": "const booking = await prisma.booking.create({ data: { providerId: body.providerId, clientId: body.clientId, serviceId: body.serviceId, startAt: new Date(body.startISO), endAt: new Date(body.endISO), status: 'confirmed', depositCents: body.depositCents ?? null } });"
            },
            {
              "type": "code_search",
              "path": "codebase",
              "lines": "search results",
              "excerpt": "No raw SQL string concatenation or manual query construction found"
            }
          ],
          "impact": {
            "confidentiality": "Protected - SQL injection prevented",
            "integrity": "Protected - database integrity maintained",
            "availability": "Protected - DoS via SQL injection prevented",
            "privilege_escalation": "Prevented - database access controlled",
            "business": "Protected - data security maintained"
          },
          "scoring": {
            "exploitability": 0,
            "impact": 0,
            "exposure_surface": 0,
            "privilege_gain": 0,
            "total_risk_score": 0,
            "severity": "informational",
            "score_justification": "SQL injection prevented by consistent ORM usage"
          },
          "confidence": "HIGH",
          "affected_components": ["Database access layer", "Prisma ORM"],
          "prerequisites": ["None - SQL injection properly prevented"],
          "notes": "Strong protection against SQL injection through consistent Prisma ORM usage"
        }
      ],
      "not_detected_statement": "No SQL injection vulnerabilities detected. Consistent use of Prisma ORM prevents SQL injection attacks."
    },
    {
      "category": "command_injection",
      "checklist": [
        {
          "item": "Identify system command execution",
          "result": "NOT_DETECTED",
          "notes": "No system command execution found"
        },
        {
          "item": "Trace user input to commands",
          "result": "NOT_DETECTED",
          "notes": "No command construction with user input"
        },
        {
          "item": "Check for unsafe patterns",
          "result": "NOT_DETECTED",
          "notes": "No shell execution patterns found"
        },
        {
          "item": "Verify environment variable handling",
          "result": "CONFIRMED",
          "notes": "Environment variables used safely"
        },
        {
          "item": "Check for indirect injection vectors",
          "result": "NOT_DETECTED",
          "notes": "No indirect command injection found"
        }
      ],
      "findings": [
        {
          "vuln_id": "VULN-CMD-001",
          "status": "NOT_DETECTED",
          "category": "command_injection",
          "title": "No Command Injection Vectors Found",
          "location": {
            "files": [],
            "routes_endpoints": [],
            "middleware": []
          },
          "description": "No command injection vulnerabilities detected. Application does not execute system commands or shell scripts with user-controlled input.",
          "attack_scenario": [
            "No attack scenario - no command execution functionality present"
          ],
          "evidence": [
            {
              "type": "code_search",
              "path": "codebase",
              "lines": "search results",
              "excerpt": "No eval, exec, spawn, child_process, or command execution functions found"
            }
          ],
          "impact": {
            "confidentiality": "Not applicable",
            "integrity": "Not applicable",
            "availability": "Not applicable",
            "privilege_escalation": "Not applicable",
            "business": "Not applicable"
          },
          "scoring": {
            "exploitability": 0,
            "impact": 0,
            "exposure_surface": 0,
            "privilege_gain": 0,
            "total_risk_score": 0,
            "severity": "informational",
            "score_justification": "No command execution functionality present"
          },
          "confidence": "HIGH",
          "affected_components": [],
          "prerequisites": ["None - no command execution present"],
          "notes": "Application does not execute system commands, eliminating command injection risk"
        }
      ],
      "not_detected_statement": "No command injection vulnerabilities detected. Application does not execute system commands or shell scripts."
    },
    {
      "category": "code_injection",
      "checklist": [
        {
          "item": "Identify dynamic code execution",
          "result": "NOT_DETECTED",
          "notes": "No eval or dynamic code execution found"
        },
        {
          "item": "Check dynamic imports",
          "result": "NOT_DETECTED",
          "notes": "No user-controlled dynamic imports found"
        },
        {
          "item": "Verify template execution",
          "result": "NOT_DETECTED",
          "notes": "No user-controlled template execution"
        },
        {
          "item": "Check for unsafe deserialization",
          "result": "NOT_DETECTED",
          "notes": "No unsafe deserialization found"
        },
        {
          "item": "Consider configuration-driven execution",
          "result": "CONFIRMED",
          "notes": "Workflow engine properly secured with whitelisting"
        }
      ],
      "findings": [
        {
          "vuln_id": "VULN-CODE-001",
          "status": "NOT_DETECTED",
          "category": "code_injection",
          "title": "Code Injection Prevented by Input Validation",
          "location": {
            "files": [
              {
                "path": "apps/business-spine/src/automation/workflow.ts",
                "lines": "L11-L18",
                "symbols": ["ALLOWED_ACTION_TYPES"]
              },
              {
                "path": "apps/business-spine/src/core/flow.ts",
                "lines": "L20-L44",
                "symbols": ["validateFlowSteps"]
              }
            ],
            "routes_endpoints": ["Workflow execution endpoints"],
            "middleware": []
          },
          "description": "Code injection prevented through comprehensive input validation, whitelisting of allowed actions, and validation of workflow steps before execution.",
          "attack_scenario": [
            "Attacker attempts code injection via workflow configuration",
            "Whitelist validation prevents malicious actions per apps/business-spine/src/automation/workflow.ts L172-L174",
            "Flow steps validated before execution per apps/business-spine/src/core/flow.ts L20-L44",
            "No eval or dynamic code execution patterns found"
          ],
          "evidence": [
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/src/automation/workflow.ts",
              "lines": "L11-L18",
              "excerpt": "const ALLOWED_ACTION_TYPES = new Set(['send_email', 'send_sms', 'create_booking', 'update_client', 'create_invoice', 'webhook']);"
            },
            {
              "type": "code_excerpt",
              "path": "apps/business-spine/src/core/flow.ts",
              "lines": "L20-L44",
              "excerpt": "function validateFlowSteps(steps: FlowStep[], env: FlowEnvironment): void { for (const step of steps) { if (step.kind === 'execute') { if (!env.tools[step.tool]) { throw new Error(`Invalid tool reference: ${step.tool}. Tool not found in environment.`); } } } }"
            },
            {
              "type": "code_search",
              "path": "codebase",
              "lines": "search results",
              "excerpt": "No eval, Function constructor, or unsafe dynamic code execution found"
            }
          ],
          "impact": {
            "confidentiality": "Protected - code injection prevented",
            "integrity": "Protected - system integrity maintained",
            "availability": "Protected - arbitrary code execution prevented",
            "privilege_escalation": "Prevented - code execution controlled",
            "business": "Protected - system security maintained"
          },
          "scoring": {
            "exploitability": 0,
            "impact": 0,
            "exposure_surface": 0,
            "privilege_gain": 0,
            "total_risk_score": 0,
            "severity": "informational",
            "score_justification": "Code injection prevented by comprehensive input validation"
          },
          "confidence": "HIGH",
          "affected_components": ["Workflow engine", "Dynamic execution controls", "Input validation"],
          "prerequisites": ["None - code injection properly prevented"],
          "notes": "Strong protection against code injection through whitelisting and input validation"
        }
      ],
      "not_detected_statement": "No code injection vulnerabilities detected. Comprehensive input validation and whitelisting prevent code injection attacks."
    }
  ],
  "blue_team_validation": {
    "source_red_team_audit_id": "AUDIT_20251222_1515",
    "changes": [],
    "rejected_findings": []
  },
  "gate": {
    "policy": {
      "fail_if": [
        { "severity_at_least": "critical", "count_gte": 1 },
        { "severity_at_least": "high", "count_gte": 2 },
        { "risk_score_gte": 17, "count_gte": 1 }
      ],
      "warn_if": [
        { "severity_at_least": "high", "count_gte": 1 },
        { "severity_at_least": "medium", "count_gte": 3 },
        { "risk_score_gte": 13, "count_gte": 2 }
      ]
    },
    "result": {
      "status": "FAIL",
      "reasons": [
        "HIGH severity vulnerability detected: Critical password hashing vulnerability",
        "Risk score 15 exceeds warning threshold",
        "Insecure password storage allows credential recovery",
        "Immediate remediation required"
      ]
    }
  }
}
